# Task: Build SPACER TUI (Interactive Chat Interface)

The SPACER package already exists with `spacer init`, `spacer status`, and `spacer bib` commands (see src/spacer/cli.py, init.py, status.py, bib.py).

## Build these new features:

### 1. `spacer auth` command
- Prompts for Anthropic API key (or reads ANTHROPIC_API_KEY env var)
- Stores in ~/.config/spacer/auth.json (chmod 600)
- Tests connection with a simple API call
- Add `anthropic` to pyproject.toml dependencies

### 2. `spacer chat` command — the main interactive interface
Use `prompt_toolkit` for a simple chat TUI.

**Layout:** Header showing phase + sub-step, chat area, input line.

**Slash commands inside chat:**
- `/status` — show pipeline status
- `/phase` — show current phase info
- `/bib search "query"` — search papers inline
- `/supply <filepath>` — read file, add to conversation context
- `/constitute` — ask agent to generate constitution from discussion
- `/review` — show current drafts for review
- `/save` — save conversation to notes/ideation/discussion-{timestamp}.md
- `/next` — advance sub-step
- `/quit` or `/exit` — exit

**LLM:** Use `anthropic` SDK, model `claude-sonnet-4-5`.

**System prompt:** Load from src/spacer/prompts/system.md (create this file). Include:
- "You are SPACER, a research paper writing agent"
- Current phase/sub-step from spacer.yaml
- McEnerney principles (instability → cost → solution, reader-focused)
- Anti-AI-speak rules (never use "delve", "moreover", "comprehensive", "leverage")
- Constitution content if constitution/ideation.md exists
- Reference rules: never generate bibtex from memory, use spacer bib

**Conversation:** Maintain history in memory. On /save or /quit, dump to markdown.

### 3. `src/spacer/auth.py` — auth logic
### 4. `src/spacer/chat.py` — TUI chat logic  
### 5. `src/spacer/prompts/system.md` — system prompt template

### Dependencies to add to pyproject.toml:
- anthropic
- prompt_toolkit

### After building:
- Run `cd /home/opclaw/spacer && uv pip install -e .` to reinstall
- Test `spacer auth` works
- Test `spacer chat` launches and accepts input
- Git commit and push to origin
